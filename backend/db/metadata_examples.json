{
  "description": "Example metadata schemas showing data lineage and scraping context",
  "examples": [
    {
      "metadata_type": "scraping_session",
      "source": "https://www.metopera.org/season/2024-25-season/",
      "scraped_at": "2025-10-25T15:30:00Z",
      "scraper_version": "1.2.0",
      "user_agent": "OperaResearchBot/1.0 (+https://github.com/austinkness/opera-research-agentic-system)",
      "page_type": "season_listing",
      "http_status": 200,
      "response_time_ms": 452,
      "content_hash": "a3f5e9b2c1d4567890abcdef12345678",
      "robots_txt_compliant": true,
      "rate_limit_delay_ms": 2000
    },
    {
      "metadata_type": "llm_extraction",
      "source_page_id": "550e8400-e29b-41d4-a716-446655440000",
      "extracted_at": "2025-10-25T15:32:15Z",
      "llm_model": "gpt-4-turbo-preview",
      "parser_version": "1.1.0",
      "extraction_prompt": "Extract production information including title, composer, dates, and cast from this opera season page",
      "fields_extracted": [
        "opera_title",
        "composer",
        "conductor",
        "premiere_date",
        "closing_date",
        "cast_members",
        "venue",
        "ticket_prices"
      ],
      "confidence_score": 0.92,
      "tokens_used": 2847,
      "cost_usd": 0.0142,
      "extraction_duration_ms": 3521,
      "validation_errors": [],
      "manual_review_required": false
    },
    {
      "metadata_type": "production_data",
      "production_id": "660e8400-e29b-41d4-a716-446655440000",
      "source_url": "https://www.metopera.org/season/2024-25-season/la-traviata/",
      "data_quality_score": 0.95,
      "completeness": {
        "core_fields": 1.0,
        "optional_fields": 0.87,
        "financial_fields": 0.45
      },
      "lineage": {
        "scraped_from": "stg_scraped_pages",
        "extracted_via": "stg_llm_extractions",
        "transformed_by": "dbt_production_model_v1.2",
        "last_updated": "2025-10-25T16:00:00Z"
      },
      "enrichments": {
        "opera_work_matched": true,
        "company_linked": true,
        "performers_identified": 8,
        "external_ids_found": ["musicbrainz", "wikidata"]
      }
    },
    {
      "metadata_type": "data_validation",
      "production_id": "660e8400-e29b-41d4-a716-446655440000",
      "validation_timestamp": "2025-10-25T16:05:00Z",
      "validation_rules_passed": 23,
      "validation_rules_failed": 2,
      "warnings": [
        {
          "rule": "ticket_price_range_reasonable",
          "message": "Ticket price max ($450) seems high, review recommended",
          "severity": "warning"
        }
      ],
      "errors": [
        {
          "rule": "closing_date_after_premiere",
          "message": "Closing date (2025-02-15) is before premiere date (2025-02-20)",
          "severity": "error",
          "auto_corrected": false
        }
      ]
    },
    {
      "metadata_type": "change_detection",
      "production_id": "660e8400-e29b-41d4-a716-446655440000",
      "change_detected_at": "2025-10-26T10:00:00Z",
      "changes": [
        {
          "field": "conductor",
          "old_value": "Yannick Nézet-Séguin",
          "new_value": "Marco Armiliato",
          "change_type": "substitution",
          "confidence": 0.98
        },
        {
          "field": "total_performances",
          "old_value": 8,
          "new_value": 10,
          "change_type": "update",
          "confidence": 1.0
        }
      ],
      "change_source": "weekly_rescrape",
      "manual_verification_required": true
    },
    {
      "metadata_type": "aggregation_context",
      "mart_table": "mart_production_summary",
      "generated_at": "2025-10-25T18:00:00Z",
      "dbt_run_id": "abc123def456",
      "source_tables": [
        "productions",
        "companies",
        "opera_works",
        "cast_assignments",
        "performances"
      ],
      "aggregation_window": {
        "start_date": "2020-01-01",
        "end_date": "2025-12-31"
      },
      "row_count": 15482,
      "dbt_tests_passed": 47,
      "dbt_tests_failed": 0,
      "materialization_strategy": "table",
      "refresh_frequency": "daily"
    }
  ],
  "metadata_usage_notes": {
    "scraping_session": "Stored in stg_scraped_pages.response_headers JSONB field",
    "llm_extraction": "Stored in stg_llm_extractions.raw_response and metadata fields",
    "production_data": "Stored in productions.source_url and data_quality_score",
    "data_validation": "Logged during dbt test runs and ETL validation steps",
    "change_detection": "Tracked for monitoring data drift and updates",
    "aggregation_context": "Generated by dbt during mart materialization"
  }
}
